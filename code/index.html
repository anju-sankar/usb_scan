<script type=”text/javascript” 
src=”node_modules/dwt/dist/dynamsoft.webtwain.initiate.js”>
</script>

<script type=”text/javascript” 
src=”node_modules/dwt/dist/dynamsoft.webtwain.config.js”>
</script>

<script>
Dynamsoft.WebTwainEnv.RegisterEvent(‘OnWebTwainReady’, Dynamsoft_OnReady);
var DWObject;
function Dynamsoft_OnReady() {
DWObject = Dynamsoft.WebTwainEnv.GetWebTwain(‘dwtcontrolContainer’);
if (DWObject) {
if (window.navigator.platform.indexOf(“Linux”) !== -1) {
DWObject.ImageCaptureDriverType = 3;
}
var count = DWObject.SourceCount;
for (var i = 0; i < count; i++)
document.getElementById(“source”).options.add(new Option(DWObject.GetSourceNameItems(i), i));
}

function AcquireImage() {
if (DWObject) {
var OnAcquireImageSuccess, OnAcquireImageFailure;
OnAcquireImageSuccess = OnAcquireImageFailure = function (){
DWObject.CloseSource();
};
DWObject.SelectSourceByIndex(document.getElementById(“source”).selectedIndex);
DWObject.OpenSource();
DWObject.IfDisableSourceAfterAcquire = true;
DWObject.AcquireImage(OnAcquireImageSuccess, OnAcquireImageFailure);
}
}
//To make code work on Linux, you need to specify the driver type:
DWObject.ImageCaptureDriverType = 3;
//5. Create server.js for back-end:
var express = require(‘express’);
var app = express();
 
app.use(express.static(__dirname));
app.use(function(req, res, next) {
 res.header(“Access-Control-Allow-Origin”, “*”);
 res.header(“Access-Control-Allow-Methods”, “PUT, POST, GET, DELETE, OPTIONS”);
 res.header(“Access-Control-Allow-Headers”, “X-Requested-With, content-type”);
 res.header(“Access-Control-Allow-Credentials”, true);
 next();
});
 
var server = app.listen(2017, function() {
 var host = server.address().address;
 var port = server.address().port;
 console.log(‘listening at http://%s:%s’, host, port);
});


</script>